# 智阅AI MVP 迭代任务清单

## 1. MVP-1: 核心阅读辅助（2-3周）

### 1.1 项目基础架构

- [ ] 1.1.1 初始化项目结构（已完成基础脚手架）
- [ ] 1.1.2 配置 TypeScript 类型定义（Chrome API、AI API）
- [ ] 1.1.3 配置构建流程（Vite 插件配置）
- [ ] 1.1.4 设置开发环境（热重载、调试工具）

### 1.2 Content Script - 划词交互

- [ ] 1.2.1 实现文本选择监听器
- [ ] 1.2.2 创建划词工具栏组件（Shadow DOM）
- [ ] 1.2.3 实现工具栏定位算法（避免遮挡）
- [ ] 1.2.4 添加工具栏按钮（简化、解释、复制）
- [ ] 1.2.5 实现工具栏自动消失逻辑（3秒无操作）
- [ ] 1.2.6 创建注入式结果展示组件（Shadow DOM）
- [ ] 1.2.7 实现结果展示动画（滑入/滑出）
- [ ] 1.2.8 添加暗黑模式支持

### 1.3 Background - 本地 AI 引擎

- [ ] 1.3.1 实现 Gemini Nano 检测逻辑
- [ ] 1.3.2 创建本地 AI 引擎类
- [ ] 1.3.3 实现长难句简化功能（提示词优化）
- [ ] 1.3.4 实现专业术语解释功能（提示词优化）
- [ ] 1.3.5 创建降级规则引擎（基础文本处理）
- [ ] 1.3.6 实现 AI 引擎自动切换逻辑
- [ ] 1.3.7 添加错误处理和重试机制

### 1.4 Background - 消息处理

- [ ] 1.4.1 创建消息路由系统
- [ ] 1.4.2 实现 Content ↔ Background 通信
- [ ] 1.4.3 添加消息类型定义（TypeScript）
- [ ] 1.4.4 实现消息队列（避免并发冲突）

### 1.5 Storage - 基础数据管理

- [ ] 1.5.1 创建配置管理模块（Chrome Storage）
- [ ] 1.5.2 实现用户设置读写（主题、开关）
- [ ] 1.5.3 添加缓存管理（术语解释缓存）
- [ ] 1.5.4 实现缓存过期清理（24小时）

### 1.6 Options - 设置页面

- [ ] 1.6.1 创建设置页面 UI（React）
- [ ] 1.6.2 实现主题切换（浅色/暗黑/自动）
- [ ] 1.6.3 添加功能开关（工具栏、本地AI）
- [ ] 1.6.4 实现设置保存和加载
- [ ] 1.6.5 添加帮助文档链接

### 1.7 测试与优化

- [ ] 1.7.1 手动测试核心功能（划词、简化、解释）
- [ ] 1.7.2 测试不同网站兼容性（技术文档、学术论文）
- [ ] 1.7.3 性能测试（响应延迟、内存占用）
- [ ] 1.7.4 修复发现的 bug
- [ ] 1.7.5 优化提示词模板（提升解析质量）

### 1.8 文档更新

- [ ] 1.8.1 更新 README.md（MVP-1 功能说明）
- [ ] 1.8.2 更新 openspec/project.md（架构说明）
- [ ] 1.8.3 创建用户使用指南（docs/USER_GUIDE.md）

## 2. MVP-2: 云端增强与知识沉淀（2-3周）

### 2.1 Cloud AI - GPT-4 集成

- [ ] 2.1.1 创建云端 AI 引擎接口（统一抽象）
- [ ] 2.1.2 实现 GPT-4 Provider
- [ ] 2.1.3 添加 API 密钥管理（加密存储）
- [ ] 2.1.4 实现 Token 计数逻辑
- [ ] 2.1.5 添加网络错误处理和重试
- [ ] 2.1.6 实现超时控制（10秒）

### 2.2 代码/公式解析

- [ ] 2.2.1 实现代码片段识别（正则匹配）
- [ ] 2.2.2 添加编程语言检测（Python/JS/Java）
- [ ] 2.2.3 实现代码解析功能（调用云端AI）
- [ ] 2.2.4 添加代码语法高亮（可选）
- [ ] 2.2.5 实现 LaTeX 公式识别
- [ ] 2.2.6 实现公式解析功能（调用云端AI）
- [ ] 2.2.7 添加公式可视化渲染（可选）

### 2.3 知识管理 - 基础存储

- [ ] 2.3.1 创建 IndexedDB 数据库结构
- [ ] 2.3.2 实现知识节点存储（CRUD）
- [ ] 2.3.3 添加节点类型定义（术语/代码/公式/结论）
- [ ] 2.3.4 实现简单关键词检索
- [ ] 2.3.5 添加数据导出功能（JSON）

### 2.4 UI - 收藏与检索

- [ ] 2.4.1 在工具栏添加"收藏"按钮
- [ ] 2.4.2 实现收藏确认提示
- [ ] 2.4.3 在 Popup 添加知识检索入口
- [ ] 2.4.4 实现检索结果展示
- [ ] 2.4.5 添加来源链接跳转功能

### 2.5 Token 管理

- [ ] 2.5.1 实现 Token 使用统计
- [ ] 2.5.2 添加预算设置功能
- [ ] 2.5.3 实现预算提醒（80%、100%）
- [ ] 2.5.4 在 Popup 显示 Token 使用情况
- [ ] 2.5.5 添加历史消耗记录（3个月）

### 2.6 安全加密

- [ ] 2.6.1 实现 AES-256-GCM 加密服务
- [ ] 2.6.2 加密 API 密钥存储
- [ ] 2.6.3 加密知识图谱敏感数据
- [ ] 2.6.4 实现设备指纹生成（密钥派生）

### 2.7 测试与优化

- [ ] 2.7.1 测试云端 AI 调用（GPT-4）
- [ ] 2.7.2 测试代码/公式解析准确性
- [ ] 2.7.3 测试知识收藏和检索
- [ ] 2.7.4 测试 Token 计数准确性
- [ ] 2.7.5 性能测试（云端响应延迟）
- [ ] 2.7.6 安全测试（加密解密）

### 2.8 文档更新

- [ ] 2.8.1 更新 README.md（MVP-2 功能说明）
- [ ] 2.8.2 更新用户指南（API 密钥配置）
- [ ] 2.8.3 添加安全说明文档

## 3. MVP-3: 高级功能与商业化（2-3周）

### 3.1 多模型支持

- [ ] 3.1.1 实现 Claude 3 Provider
- [ ] 3.1.2 实现文心一言 Provider
- [ ] 3.1.3 添加模型切换 UI（Options）
- [ ] 3.1.4 实现默认模型设置
- [ ] 3.1.5 添加按场景自动推荐模型

### 3.2 多文档对比

- [ ] 3.2.1 实现跨标签页文档选择
- [ ] 3.2.2 提取文档核心信息（前1000字符）
- [ ] 3.2.3 实现对比分析逻辑（调用云端AI）
- [ ] 3.2.4 生成结构化对比表格
- [ ] 3.2.5 添加对比结果展示 UI

### 3.3 知识图谱构建

- [ ] 3.3.1 实现 TF-IDF 向量计算
- [ ] 3.3.2 实现余弦相似度计算
- [ ] 3.3.3 实现节点关联算法
- [ ] 3.3.4 推断关联类型（包含/改进/相关）
- [ ] 3.3.5 实现图谱自动更新（新增节点时）
- [ ] 3.3.6 添加图谱可视化（可选）

### 3.4 自然语言检索

- [ ] 3.4.1 实现查询意图提取（本地AI）
- [ ] 3.4.2 实现向量检索算法
- [ ] 3.4.3 优化检索排序（相关性评分）
- [ ] 3.4.4 实现 Top 5 结果返回
- [ ] 3.4.5 添加检索结果高亮

### 3.5 订阅与付费

- [ ] 3.5.1 创建订阅管理模块
- [ ] 3.5.2 实现试用期逻辑（7天）
- [ ] 3.5.3 实现功能门控（Feature Gate）
- [ ] 3.5.4 添加付费功能提示 UI
- [ ] 3.5.5 创建订阅对比页面
- [ ] 3.5.6 添加"开通高级版"入口

### 3.6 高级 UI

- [ ] 3.6.1 优化 Popup 界面（知识图谱入口）
- [ ] 3.6.2 添加模型切换下拉菜单
- [ ] 3.6.3 实现多文档对比 UI
- [ ] 3.6.4 优化知识检索结果展示
- [ ] 3.6.5 添加订阅状态显示

### 3.7 测试与优化

- [ ] 3.7.1 测试多模型切换
- [ ] 3.7.2 测试多文档对比准确性
- [ ] 3.7.3 测试知识图谱构建性能
- [ ] 3.7.4 测试自然语言检索准确性
- [ ] 3.7.5 测试付费功能门控
- [ ] 3.7.6 完整功能回归测试
- [ ] 3.7.7 性能优化（内存、CPU）

### 3.8 上线准备

- [ ] 3.8.1 准备 Chrome Web Store 素材（图标、截图、描述）
- [ ] 3.8.2 编写隐私政策
- [ ] 3.8.3 编写用户协议
- [ ] 3.8.4 配置 CI/CD 自动发布
- [ ] 3.8.5 创建产品官网（可选）

### 3.9 文档更新

- [ ] 3.9.1 更新 README.md（完整功能说明）
- [ ] 3.9.2 更新用户指南（高级功能使用）
- [ ] 3.9.3 创建 FAQ 文档
- [ ] 3.9.4 创建更新日志（CHANGELOG.md）

## 4. 后续迭代（可选）

### 4.1 功能增强

- [ ] 4.1.1 跨会话上下文记忆
- [ ] 4.1.2 行业知识库定制
- [ ] 4.1.3 自定义提示词模板
- [ ] 4.1.4 批量文档处理
- [ ] 4.1.5 导出为 Markdown/PDF

### 4.2 集成与扩展

- [ ] 4.2.1 Notion 集成
- [ ] 4.2.2 VS Code 集成
- [ ] 4.2.3 Obsidian 集成
- [ ] 4.2.4 私有模型接入
- [ ] 4.2.5 云端数据同步

### 4.3 商业化增强

- [ ] 4.3.1 团队订阅支持
- [ ] 4.3.2 企业定制版
- [ ] 4.3.3 API 开放平台
- [ ] 4.3.4 数据分析后台
